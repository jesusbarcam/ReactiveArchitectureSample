{"version":3,"file":"/Users/Rawdog/Developer/Curses/AngularUniversity/Angular NgRx Store Reactive Architecture/Repository/ReactiveArchitectureSample/src/server/api/apiMessageNotificationsPerUser.ts","sources":["/Users/Rawdog/Developer/Curses/AngularUniversity/Angular NgRx Store Reactive Architecture/Repository/ReactiveArchitectureSample/src/server/api/apiMessageNotificationsPerUser.ts"],"names":[],"mappings":";;AAIA,sCAAyE;AAGzE,wCAA+C,GAAgB;IAG3D,GAAG,CAAC,KAAK,CAAC,6BAA6B,CAAC,CAAC,IAAI,CAAC,UAAC,GAAG,EAAE,GAAG;QAEnD,IAAM,aAAa,GAAG,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QAE5C,EAAE,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC;YACjB,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAC,EAAE,EAAC,CAAC,CAAC;YACnC,MAAM,CAAC;QACX,CAAC;QAED,IAAM,gBAAgB,GAAG,gCAAsB,CAAC,aAAa,CAAC,CAAC;QAE/D,IAAM,cAAc,GAAG,gBAAgB,CAAC,GAAG,CAAE,UAAA,SAAS,IAAI,OAAA,oBAAU,CAAC,SAAS,CAAC,EAArB,CAAqB,CAAE,CAAC;QAElF,gCAAsB,CAAC,aAAa,CAAC,GAAG,EAAE,CAAC;QAE3C,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,cAAc,EAAC,CAAC,CAAC;IAEpD,CAAC,CAAC,CAAC;AAEP,CAAC;AAtBD,wEAsBC","sourcesContent":["\n\n\nimport {Application} from 'express';\nimport {dbMessagesQueuePerUser, dbMessages, dbThreads} from \"../db-data\";\n\n\nexport function apiMessageNotificationsPerUser(app: Application) {\n\n\n    app.route('/api/notifications/messages').post((req, res) => {\n\n        const participantId = req.headers['userid'];\n\n        if (!participantId) {\n            res.status(200).json({payload:[]});\n            return;\n        }\n\n        const unreadMessageIds = dbMessagesQueuePerUser[participantId];\n\n        const unreadMessages = unreadMessageIds.map( messageId => dbMessages[messageId] );\n\n        dbMessagesQueuePerUser[participantId] = [];\n\n        res.status(200).json({payload: unreadMessages});\n\n    });\n\n}"]}